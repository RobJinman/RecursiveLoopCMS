<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<div xmlns="http://www.w3.org/1999/xhtml"   
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

  <c:set var="parent" value="#{ request.getParameter('parent') }" scope="request"/>
  <c:set var="typeName" value="#{ request.getParameter('type') }" scope="request"/>
  <c:set var="type" value="#{ jcrBean.getType(typeName) }" scope="request"/>

  <div class="item-info">
    <span class="lbl-item-info">Parent: </span><span class="item-info-dat">#{ parent }</span>
    <span class="lbl-item-info">Type: </span><span class="item-info-dat">#{ typeName }</span>
  </div>

  <form id="frm-item-info" class="col-sm-offset-1">
    <div class="form-group col-sm-4">
      <label for="txt-item-type">Type</label>
      <input id="txt-item-type" class="form-control" type="text" name="type" value="#{ typeName }"/>
    </div>
    <div class="form-group col-sm-4">
      <label for="txt-item-parent">Parent</label>
      <input id="txt-item-parent" class="form-control" type="text" name="parent" value="#{ parent }"/>
    </div>
    <div class="form-group col-sm-4">
      <label for="txt-item-name">Name</label>
      <input id="txt-item-name" class="form-control" name="name" type="text"/>
    </div>
  </form>

  <form id="frm-item-content" class="form-horizontal">
    <c:if test="#{ !type.isNull() }">
      <c:forEach var="field" items="#{ type.fields }">
        <c:choose>
          <c:when test="#{ field.widget == 'textedit' }">
            <div class="form-group">
              <label class="col-sm-1 control-label" for="f-#{ field.name }">#{ field.name }</label>
              <div class="col-sm-11">
                <input id="f-#{ field.name }" class="form-control" name="#{ field.name }" type="text"/>
              </div>
            </div>
          </c:when>
          <c:when test="#{ field.widget == 'textarea' }">
            <div class="form-group">
              <label class="col-sm-1 control-label" for="f-#{ field.name }">#{ field.name }</label>
              <div class="col-sm-11">
                <textarea id="f-#{ field.name }" class="form-control" name="#{ field.name }" rows="4" cols="50"></textarea>
              </div>
            </div>
          </c:when>
          <c:when test="#{ field.widget == 'spinbox' }">
            <div class="form-group">
              <label class="col-sm-1 control-label" for="f-#{ field.name }">#{ field.name }</label>
              <div class="col-sm-11">
                <input class="spinner" id="f-#{ field.name }" name="#{ field.name }"/>
              </div>
            </div>
          </c:when>
          <c:when test="#{ field.widget == 'datepicker' }">
            <div class="form-group">
              <label class="col-sm-1 control-label" for="f-#{ field.name }">#{ field.name }</label>
              <div class="col-sm-11">
                <input class="datepicker form-control" type="text" id="f-#{ field.name }" name="#{ field.name }"/>
              </div>
            </div>
          </c:when>
          <c:otherwise>
          </c:otherwise>
        </c:choose>
      </c:forEach>
      <div class="form-group">
        <div class="col-sm-offset-1 col-sm-11">
          <button type="button" class="btn btn-default" onclick="app.page.newItem()">Save</button>
        </div>
      </div>
    </c:if>
    <c:if test="#{ type.isNull() }">
      <span class="err-no-type">No type info</span>
    </c:if>
  </form>
</div>

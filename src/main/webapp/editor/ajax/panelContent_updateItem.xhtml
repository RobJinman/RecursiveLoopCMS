<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<div xmlns="http://www.w3.org/1999/xhtml"   
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

  <c:set var="itemPath" value="#{ request.getParameter('item') }" scope="request"/>
  <c:set var="item" value="#{ jcrBean.getStringItem(itemPath) }" scope="request"/>
  <c:set var="type" value="#{ jcrBean.getType(item.typeName) }" scope="request"/>

  <span id="item-data"
    data-item-name="#{ item.name }"
    data-item-path="#{ item.path }"
    data-item-type="#{ item.typeName }"/>

  <div class="item-info">
    <span class="lbl-item-info">Name: </span><span class="item-info-dat">#{ item.name }</span>
    <span class="lbl-item-info">Type: </span><span class="item-info-dat">#{ item.typeName }</span>
  </div>

  <form id="frm-item-content" class="form-horizontal">
    <c:if test="#{ !type.isNull() }">
      <c:forEach var="field" items="#{ type.fields }">
        <c:set var="content" value="#{ item.getProperty(field.name) }"/>
        <c:choose>
          <c:when test="#{ field.widget == 'textedit' }">
            <div class="form-group">
              <label class="col-sm-1 control-label" for="f-#{ field.name }">#{ field.name }</label>
              <div class="col-sm-11">
                <input id="f-#{ field.name }" class="form-control" name="#{ field.name }" type="text" value="#{ content }"/>
              </div>
            </div>
          </c:when>
          <c:when test="#{ field.widget == 'textarea' }">
            <div class="form-group">
              <label class="col-sm-1 control-label" for="f-#{ field.name }">#{ field.name }</label>
              <div class="col-sm-11">
                <textarea id="f-#{ field.name }" class="form-control" name="#{ field.name }" rows="4" cols="50">#{ content }</textarea>
              </div>
            </div>
          </c:when>
          <c:when test="#{ field.widget == 'spinbox' }">
            <div class="form-group">
              <label class="col-sm-1 control-label" for="f-#{ field.name }">#{ field.name }</label>
              <div class="col-sm-11">
                <input class="spinner" id="f-#{ field.name }" name="#{ field.name }" value="#{ content }"/>
              </div>
            </div>
          </c:when>
          <c:when test="#{ field.widget == 'datepicker' }">
            <div class="form-group">
              <label class="col-sm-1 control-label" for="f-#{ field.name }">#{ field.name }</label>
              <div class="col-sm-11">
                <input class="datepicker form-control" type="text" id="f-#{ field.name }" name="#{ field.name }" value="#{ content }"/>
              </div>
            </div>
          </c:when>
          <c:otherwise>
          </c:otherwise>
        </c:choose>
      </c:forEach>
      <div class="form-group">
        <div class="col-sm-offset-1 col-sm-11">
          <button type="button" class="btn btn-default" onclick="app.page.updateItem()">Save</button>
        </div>
      </div>
    </c:if>
    <c:if test="#{ type.isNull() }">
      <span class="err-no-type">No type info</span>
    </c:if>
  </form>
</div>
